---
# DEMO:
# ====
# - name: Install notify
#   ansible.builtin.import_role: { name: bookshelf-notify-sh }
#   # noqa: var-naming[no-role-prefix]
#   vars:
#     bookshelf_notify_prereqs: false           # <- (OPTIONAL) Install prereqs, defaults to false
#     bookshelf_notify_sh_dest: ~/notify.sh     # <- (OPTIONAL) Defaults to bookshelf_notify_sh_path value

- name: Load prereqs
  ansible.builtin.include_tasks:
    file: prereqs.yaml
  when: bookshelf_notify_prereqs | default(false, true)

- name: Notify.sh
  vars:
    dest: "{{ bookshelf_notify_sh_dest | default(bookshelf_notify_sh_path, true) }}"
  block:
    - name: Create home directory
      ansible.builtin.file:
        path: "{{ dest_dir }}"
        state: directory
        mode: "{{ omit }}"
      vars:
        dest_dir: "{{ dest | dirname }}"

    - name: Install
      ansible.builtin.copy:
        src: notify.sh
        dest: "{{ dest }}"
        mode: '0755'
