{% set version = (twingate_version | default(bookshelf_const_version.twingate, true)) %}
{% set tag_rex = twingate_tag_rex | default(bookshelf_const_version.twingate_tag_rex, true) %}
---
# https://www.twingate.com/docs/deploy-connector-with-docker-compose

services:
  twingate-connector:
    # https://hub.docker.com/r/twingate/connector/tags
    image: twingate/connector:{{ version }}
    container_name: {{ twingate_service_name }}
    restart: unless-stopped
    labels:
      - wud.watch={{ twingate_wudded }}
      - wud.tag.include={{ tag_rex }}
    env_file:
      - ./secret.env
      - ./main.env
    hostname: {{ twingate_hostname }}
    network_mode: bridge
    # network_mode: host  # <- Make Connector available only in local network
#     sysctls:
#       net.ipv4.ping_group_range: '0 2147483647'
